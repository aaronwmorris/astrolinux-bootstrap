---
# tasks file for astrolinux-bootstrap

#- debug:
#    var: ansible_facts
#  tags:
#    - always


- set_fact:
    dist_ver: "{{ dist_ver_list | join('') }}"
  vars:
    dist_ver_list:
      - "{{ ansible_facts['distribution'] }}"
      - "{{ ansible_facts['distribution_major_version'] }}"
  tags:
    - always


#- debug:
#    var: dist_ver
#  tags:
#    - always


- debug:
    msg: "Detected: {{ ansible_facts['distribution'] }} {{ ansible_facts['distribution_major_version'] }} ({{ ansible_facts['architecture'] }})"
  tags:
    - always


- name: Include OS Distribution Family vars
  include_vars: "{{ ansible_facts['distribution'] }}-{{ ansible_facts['distribution_major_version'] }}.yml"
  tags:
    - always


- name: Create Projects build folder
  file:
    path: "{{ projects_folder }}/build"
    state: directory
  tags:
    - always


- name: Create Projects src folder
  file:
    path: "{{ projects_folder }}/src"
    state: directory
  tags:
    - always


- name: Create downloads folder
  file:
    path: "{{ downloads_folder }}"
    state: directory
  tags:
    - always


- include: "common/main_pre.yml"
  tags:
    - common


- include: "indi-core/main.yml"
  tags:
    - indi_core
    - indi


- include: "indi-3rdparty/main.yml"
  tags:
    - indi_3rdparty
    - indi


- include: "indiweb/main.yml"
  tags:
    - indiweb
    - indi


- include: "indihub/main.yml"
  tags:
    - indihub
    - indi


- include: "astrometry.net/main.yml"
  tags:
    - astrometry.net


- include: "astrometry.net_indexes/main.yml"
  tags:
    - never
    - astrometry.net_indexes
    - download


- include: "astap/main.yml"
  tags:
    - astap


- include: "astap_indexes/main.yml"
  tags:
    - never
    - astap_indexes
    - download


- include: "stellarsolver/main.yml"
  tags:
    - stellarsolver


- include: "sextractor/main.yml"
  tags:
    - sextractor


- include: "kstars/main.yml"
  tags:
    - kstars


- include: "stellarium/main.yml"
  tags:
    - stellarium


- include: "phd2/main.yml"
  tags:
    - phd2


- include: "lin_guider/main.yml"
  tags:
    - lin_guider


- include: "oacapture/main.yml"
  tags:
    - oacapture


- include: "libpasastro/main.yml"
  tags:
    - libpasastro


- include: "ccdciel/main.yml"
  tags:
    - ccdciel


- include: "eqmodgui/main.yml"
  tags:
    - eqmodgui


- include: "indistarter/main.yml"
  tags:
    - indistarter
    - indi


- include: "gpredict/main.yml"
  tags:
    - gpredict


- include: "xrdp/main.yml"
  become: yes
  tags:
    - xrdp


- include: "common/main_post.yml"
  tags:
    - common

